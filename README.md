# PythonVulnerabilityScanner
# This is a scanner that checks for vulnerabilities in Python packages that are installed on your system.

import subprocess
import json

def get_installed_packages():
    """Retrieve a list of installed Python packages using pip."""
    result = subprocess.run(['pip', 'list', '--format=json'], capture_output=True, text=True)
    packages = json.loads(result.stdout)
    return {pkg['name']: pkg['version'] for pkg in packages}

def check_vulnerabilities(installed_packages):
    """Check installed packages against a list of known vulnerabilities."""
    # Example vulnerabilities (should be updated with real data from a security database)
    known_vulnerabilities = {
        'flask': ['0.12', '1.0'],
        'requests': ['2.19.1'],
        'numpy': ['1.16.0', '1.16.1', '1.16.2'],
    }
    
    vulnerabilities_found = {}
    for package, version in installed_packages.items():
        if package.lower() in known_vulnerabilities:
            if version in known_vulnerabilities[package.lower()]:
                vulnerabilities_found[package] = version
    return vulnerabilities_found

def main():
    """Main function to run the vulnerability scanner."""
    installed_packages = get_installed_packages()
    vulnerabilities = check_vulnerabilities(installed_packages)
    if vulnerabilities:
        print("Vulnerabilities found:")
        for pkg, ver in vulnerabilities.items():
            print(f"{pkg} version {ver} is vulnerable")
    else:
        print("No vulnerabilities found.")

if __name__ == "__main__":
    main()
